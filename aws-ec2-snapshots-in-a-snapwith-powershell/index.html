<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>AWS EC2 Snapshots in a Snap
with PowerShell</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/main/css/main.css?v=ff91a822b0" />
    <noscript><link rel="stylesheet" href="/assets/main/css/noscript.css?v=ff91a822b0" /></noscript>

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="canonical" href="http://Scott-Bollinger.com/aws-ec2-snapshots-in-a-snapwith-powershell/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="http://Scott-Bollinger.com/aws-ec2-snapshots-in-a-snapwith-powershell/amp/" />
    
    <meta property="og:site_name" content="Scott-Bollinger.com" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="AWS EC2 Snapshots in a Snap
with PowerShell" />
    <meta property="og:description" content="Snapshots
I needed a process that would give me basic protection in AWS and take snapshots
of my EC2 instances as a DR/BR backup process.

The EC2 snapshots are kept in S3 which gives me 99.99% availability, across the
other availability zones in the AWS region. Meaning I&#x27;d be covered from an AZ
failure.

Building on that, I would copy the snapshots to S3 in another AWS region. Which
would cover me in a region failure.

Anyone doing this? Doing this plus traditional backups too?

For the first p" />
    <meta property="og:url" content="http://Scott-Bollinger.com/aws-ec2-snapshots-in-a-snapwith-powershell/" />
    <meta property="article:published_time" content="2015-07-08T16:00:00.000Z" />
    <meta property="article:modified_time" content="2019-10-20T14:03:05.000Z" />
    <meta property="article:tag" content="Virtualization" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="AWS EC2 Snapshots in a Snap
with PowerShell" />
    <meta name="twitter:description" content="Snapshots
I needed a process that would give me basic protection in AWS and take snapshots
of my EC2 instances as a DR/BR backup process.

The EC2 snapshots are kept in S3 which gives me 99.99% availability, across the
other availability zones in the AWS region. Meaning I&#x27;d be covered from an AZ
failure.

Building on that, I would copy the snapshots to S3 in another AWS region. Which
would cover me in a region failure.

Anyone doing this? Doing this plus traditional backups too?

For the first p" />
    <meta name="twitter:url" content="http://Scott-Bollinger.com/aws-ec2-snapshots-in-a-snapwith-powershell/" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Scott Bollinger / @kfalconspb" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Virtualization" />
    <meta name="twitter:site" content="@kfalconspb" />
    <meta name="twitter:creator" content="@kfalconspb" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Scott-Bollinger.com",
        "logo": {
            "@type": "ImageObject",
            "url": "http://Scott-Bollinger.com/favicon.ico",
            "width": 32,
            "height": 32
        }
    },
    "author": {
        "@type": "Person",
        "name": "Scott Bollinger / @kfalconspb",
        "image": {
            "@type": "ImageObject",
            "url": "http://Scott-Bollinger.com/content/images/2019/10/kfalconspb.jpg",
            "width": 399,
            "height": 399
        },
        "url": "http://Scott-Bollinger.com/author/kfalconspb/",
        "sameAs": [
            "http://Scott-Bollinger.com",
            "https://twitter.com/kfalconspb"
        ]
    },
    "headline": "AWS EC2 Snapshots in a Snap\nwith PowerShell",
    "url": "http://Scott-Bollinger.com/aws-ec2-snapshots-in-a-snapwith-powershell/",
    "datePublished": "2015-07-08T16:00:00.000Z",
    "dateModified": "2019-10-20T14:03:05.000Z",
    "keywords": "Virtualization",
    "description": "Snapshots\nI needed a process that would give me basic protection in AWS and take snapshots\nof my EC2 instances as a DR/BR backup process.\n\nThe EC2 snapshots are kept in S3 which gives me 99.99% availability, across the\nother availability zones in the AWS region. Meaning I&#x27;d be covered from an AZ\nfailure.\n\nBuilding on that, I would copy the snapshots to S3 in another AWS region. Which\nwould cover me in a region failure.\n\nAnyone doing this? Doing this plus traditional backups too?\n\nFor the first p",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://Scott-Bollinger.com/"
    }
}
    </script>

    <meta name="generator" content="Ghost 2.31" />
    <link rel="alternate" type="application/rss+xml" title="Scott-Bollinger.com" href="http://Scott-Bollinger.com/rss/" />
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-48318522-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-48318522-3');
</script>


</head>
<body class="is-preload post-template tag-virtualization">

    <div id="wrapper" >


        <header id="header">
                <a href="http://Scott-Bollinger.com" class="logo">Scott-Bollinger.com</a>
        </header>

            <nav id="nav">
    <ul class="links">
        <li class="nav-home "><a href="http://Scott-Bollinger.com/">Home</a></li>
        <li class="nav-disclaimer "><a href="http://Scott-Bollinger.com/disclaimer-do-good-enjoy-life-and-have-fun-in-all-you-do/">Disclaimer</a></li>
        <li class="nav-about "><a href="http://Scott-Bollinger.com/author/kfalconspb/">About</a></li>
    </ul>
    <ul class="icons">
        <li><a href="https://twitter.com/kfalconspb" class="icon fa-twitter" title="Twitter"><span class="label">Twitter</span></a></li>
        <li><a href="http://Scott-Bollinger.com/rss/" class="icon fa-rss" target="_blank" rel="noopener"><span class="label" title="RSS">RSS</span></a></li>
    </ul>
</nav>


        

<main id="main">

    <section class="post">

        <header class="major">
            <span class="date">July 8, 2015</span>
            <h1>AWS EC2 Snapshots in a Snap
with PowerShell</h1>
        </header>


        <div class="content">
            <h3 id="snapshots"><strong>Snapshots</strong></h3><p>I needed a process that would give me basic protection in AWS and take snapshots of my EC2 instances as a DR/BR backup process.</p><p>The EC2 snapshots are kept in S3 which gives me 99.99% availability, across the other availability zones in the AWS region. Meaning I'd be covered from an AZ failure.</p><p>Building on that, I would copy the snapshots to S3 in another AWS region. Which would cover me in a region failure.</p><p>Anyone doing this? Doing this plus traditional backups too?</p><p>For the first part of the process I could use AWS cli or AWS PowerShell commands. Both are installed on my Windows instances. A few minutes in google, and a had a few to choose from.</p><p>I ended up testing and using <a href="https://github.com/CaseyLabs/aws-ec2-ebs-automatic-snapshot-powershell">https://github.com/CaseyLabs/aws-ec2-ebs-automatic-snapshot-powershell</a> by <a href="https://www.caseylabs.com/">https://www.caseylabs.com</a></p><p>The Readme describes</p><p>"How it works: These scripts will:</p><p>Start diskshadow on your instance, in order to keep disk consistency.</p><p>Determine the instance ID of the EC2 server on which the script runs.</p><p>Gather a list of all volume IDs attached to that instance.</p><p>Take a snapshot of each attached volume</p><p>The script will then delete all associated snapshots taken by the script that are older than 7 days</p><p>Stop diskshadow to allow disk writes again."</p><p>Scheduled task that runs</p><p><code>powershell.exe -ExecutionPolicy Bypass -file "C:\aws\1-start-ebs-snapshot.ps1"</code></p><p>The number of days to keep the snapshots is configurable. You also have to have run AWS config to get your default region and point the second cmd file to the 2nd AWS location. Or preconfigure the file and copy it to the location in your script.</p><p>Next I'll be working on the copy script for S3 from region to region. Shouldn't be too bad, but I don't like having a utilities box and a single point of failure for that process.</p><p>Update: 7/9 met with AWS. You can copies the snapshots from region to region but not directly with S3 commands.</p><p>Thoughts?</p><p>How did you architect DR/BR and backups in AWS?</p><p>What about traditional backups? File level backup to S3?</p><p>Hit me up on twitter and let me know.</p>
        </div>


        <footer class="post-footer">

            <div class="authors">
                <a class="author-box" href="/author/kfalconspb/">
                    <img class="author-profile-image" src="http://Scott-Bollinger.com/content/images/2019/10/kfalconspb.jpg" alt="Scott Bollinger / @kfalconspb" />
                    <section class="author-box-content">
                        <div class="author-box-label">Author</div>
                        <h5 class="author-box-name">Scott Bollinger / @kfalconspb</h5>
                        <p>I&#x27;m Scott Bollinger / @kfalconspb, and have been an IT professional for 25 years. Half that time, in a Fortune 50 financial corporation, and the other half with small/medium size businesses.</p>
                    </section>
                </a>
            </div>

        </footer>

    </section>

</main>


<script>
    var images = document.querySelectorAll('.kg-gallery-image img');
    images.forEach(function (image) {
        var container = image.closest('.kg-gallery-image');
        var width = image.attributes.width.value;
        var height = image.attributes.height.value;
        var ratio = width / height;
        container.style.flex = ratio + ' 1 0%';
    })
</script>


        <div id="copyright">
            <ul>
                <li><Scott-Bollinger.com> Copyright &copy; 2019 <a href="/author/kfalconspb/">Scott Bollinger</a> / <a href="https://twitter.com/kfalconspb" target="_blank">@kfalconspb</a></li>
            </ul>
        </div>

    </div>


    <script src="/assets/main/js/jquery.min.js?v=ff91a822b0"></script>
    <script src="/assets/main/js/jquery.scrollex.min.js?v=ff91a822b0"></script>
    <script src="/assets/main/js/jquery.scrolly.min.js?v=ff91a822b0"></script>
    <script src="/assets/main/js/browser.min.js?v=ff91a822b0"></script>
    <script src="/assets/main/js/breakpoints.min.js?v=ff91a822b0"></script>
    <script src="/assets/main/js/util.js?v=ff91a822b0"></script>
    <script src="/assets/main/js/main.js?v=ff91a822b0"></script>

    

</body>
</html>
