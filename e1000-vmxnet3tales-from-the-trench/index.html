<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>E1000/VMXnet3
Tales from the Trench</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/main/css/main.css?v=2acc13b332" />
    <noscript><link rel="stylesheet" href="/assets/main/css/noscript.css?v=2acc13b332" /></noscript>

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="canonical" href="http://Scott-Bollinger.com/e1000-vmxnet3tales-from-the-trench/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="http://Scott-Bollinger.com/e1000-vmxnet3tales-from-the-trench/amp/" />
    
    <meta property="og:site_name" content="Scott-Bollinger.com" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="E1000/VMXnet3
Tales from the Trench" />
    <meta property="og:description" content="A silent killer
Was it a disaster situation? A 0-day? or a data center fire? Nope, not a flashy
problem or even a spectacular firestorm.

It was a simple change
An inadvertent change of a Microsoft Server 2012 R2 VMware template&#x27;s NIC from
VMXNET3 to E1000. Effectively reducing the NIC bandwidth from 10Gb to 1Gb as
well as other benefits of using the VMXNET3 driver over the emulated driver of
the E1000. This went unnoticed and affected ~50 VM&#x27;s.

Slowness
A coworker was troubleshooting backup sl" />
    <meta property="og:url" content="http://Scott-Bollinger.com/e1000-vmxnet3tales-from-the-trench/" />
    <meta property="article:published_time" content="2016-03-08T17:00:00.000Z" />
    <meta property="article:modified_time" content="2019-10-20T13:40:44.000Z" />
    <meta property="article:tag" content="Virtualization" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="E1000/VMXnet3
Tales from the Trench" />
    <meta name="twitter:description" content="A silent killer
Was it a disaster situation? A 0-day? or a data center fire? Nope, not a flashy
problem or even a spectacular firestorm.

It was a simple change
An inadvertent change of a Microsoft Server 2012 R2 VMware template&#x27;s NIC from
VMXNET3 to E1000. Effectively reducing the NIC bandwidth from 10Gb to 1Gb as
well as other benefits of using the VMXNET3 driver over the emulated driver of
the E1000. This went unnoticed and affected ~50 VM&#x27;s.

Slowness
A coworker was troubleshooting backup sl" />
    <meta name="twitter:url" content="http://Scott-Bollinger.com/e1000-vmxnet3tales-from-the-trench/" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Scott Bollinger / @kfalconspb" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Virtualization" />
    <meta name="twitter:site" content="@kfalconspb" />
    <meta name="twitter:creator" content="@kfalconspb" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Scott-Bollinger.com",
        "logo": {
            "@type": "ImageObject",
            "url": "http://Scott-Bollinger.com/favicon.ico",
            "width": 32,
            "height": 32
        }
    },
    "author": {
        "@type": "Person",
        "name": "Scott Bollinger / @kfalconspb",
        "image": {
            "@type": "ImageObject",
            "url": "http://Scott-Bollinger.com/content/images/2019/10/kfalconspb.jpg",
            "width": 399,
            "height": 399
        },
        "url": "http://Scott-Bollinger.com/author/kfalconspb/",
        "sameAs": [
            "http://Scott-Bollinger.com",
            "https://twitter.com/kfalconspb"
        ]
    },
    "headline": "E1000/VMXnet3\nTales from the Trench",
    "url": "http://Scott-Bollinger.com/e1000-vmxnet3tales-from-the-trench/",
    "datePublished": "2016-03-08T17:00:00.000Z",
    "dateModified": "2019-10-20T13:40:44.000Z",
    "keywords": "Virtualization",
    "description": "A silent killer\nWas it a disaster situation? A 0-day? or a data center fire? Nope, not a flashy\nproblem or even a spectacular firestorm.\n\nIt was a simple change\nAn inadvertent change of a Microsoft Server 2012 R2 VMware template&#x27;s NIC from\nVMXNET3 to E1000. Effectively reducing the NIC bandwidth from 10Gb to 1Gb as\nwell as other benefits of using the VMXNET3 driver over the emulated driver of\nthe E1000. This went unnoticed and affected ~50 VM&#x27;s.\n\nSlowness\nA coworker was troubleshooting backup sl",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://Scott-Bollinger.com/"
    }
}
    </script>

    <meta name="generator" content="Ghost 2.31" />
    <link rel="alternate" type="application/rss+xml" title="Scott-Bollinger.com" href="http://Scott-Bollinger.com/rss/" />
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-48318522-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-48318522-3');
</script>


</head>
<body class="is-preload post-template tag-virtualization">

    <div id="wrapper" >


        <header id="header">
                <a href="http://Scott-Bollinger.com" class="logo">Scott-Bollinger.com</a>
        </header>

            <nav id="nav">
    <ul class="links">
        <li class="nav-home "><a href="http://Scott-Bollinger.com/">Home</a></li>
        <li class="nav-disclaimer "><a href="http://Scott-Bollinger.com/disclaimer-do-good-enjoy-life-and-have-fun-in-all-you-do/">Disclaimer</a></li>
        <li class="nav-about "><a href="http://Scott-Bollinger.com/author/kfalconspb/">About</a></li>
    </ul>
    <ul class="icons">
        <li><a href="https://twitter.com/kfalconspb" class="icon fa-twitter" title="Twitter"><span class="label">Twitter</span></a></li>
        <li><a href="http://Scott-Bollinger.com/rss/" class="icon fa-rss" target="_blank" rel="noopener"><span class="label" title="RSS">RSS</span></a></li>
    </ul>
</nav>


        

<main id="main">

    <section class="post">

        <header class="major">
            <span class="date">March 8, 2016</span>
            <h1>E1000/VMXnet3
Tales from the Trench</h1>
        </header>


        <div class="content">
            <!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="https://scott-bollinger.com/img/powercli.jpg" class="kg-image" alt="PowerCLI Logo"></figure><!--kg-card-end: image--><h3 id="a-silent-killer"><strong>A silent killer</strong></h3><p>Was it a disaster situation? A 0-day? or a data center fire? Nope, not a flashy problem or even a spectacular firestorm.</p><h3 id="it-was-a-simple-change"><strong>It was a simple change</strong></h3><p>An inadvertent change of a Microsoft Server 2012 R2 VMware template's NIC from VMXNET3 to E1000. Effectively reducing the NIC bandwidth from 10Gb to 1Gb as well as other benefits of using the VMXNET3 driver over the emulated driver of the E1000. This went unnoticed and affected ~50 VM's.</p><h3 id="slowness"><strong>Slowness</strong></h3><p>A coworker was troubleshooting backup slowness issues and brought his findings to me.</p><p>I used the below PowerCLI command on each vCenter to view and exported to CSV any VM whose NIC was not equal to "Vmxnet3". Thanks to <a href="https://twitter.com/LucD22">@LucD22</a> from a 2012 post <a href="https://communities.vmware.com/thread/395849">https://communities.vmware.com/thread/395849</a></p><p><code>Connect-VIServer vserver.yourdomain.com Get-VM | Get-NetworkAdapter | Where-object {$_.Type -ne &amp;amp;amp;amp;amp;quot;Vmxnet3&amp;amp;amp;amp;amp;quot;} | Select @{N=&amp;amp;amp;amp;amp;quot;VM&amp;amp;amp;amp;amp;quot;;E={$_.Parent.Name}},Name,Type | export-Csv  c:\temp\Network_Interface.csv -NoTypeInformation</code></p><h3 id="results"><strong>Results</strong></h3><p>The resulting CSV file looks like the below.  Some VM's needed to stay on e1000 as they were Linux appliances, but approximately 50 Windows VM's needed to be changed.</p><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="https://scott-bollinger.com/img/niccsv.png" class="kg-image" alt="PowerCLI CSV Results"></figure><!--kg-card-end: image--><h3 id="resolution"><strong>Resolution</strong></h3><p>The resolution didn't turn out to be as easy as just changing the Network Interface to VMXnet3. A PowerCLI one liner would have finished the job in a couple of minutes, but it was not to be.</p><p>Changing the VMs existing Network Interface from E1000 to VMXnet3 was not the problem. The VM Operating System was having the issue, 2012R2 didn't recognize the NIC as having changed. Even after a reboot and scanning for new hardware changes in Device Manager. Since I was going to have to reconfigure the static IP addressing information anyway, I ended up just deleting the existing NIC's and adding a new one. Booting the VM and re-configuring the IP information. I had maintenance down time at night so the ~50 VM's were changed starting with higher priority servers. If I had more VM's to correct I would have looked for a fully automated solution.</p><h3 id="lessons-learned"><strong>Lessons Learned</strong></h3><p>Templates changes should be reported on and should be checked periodically for adherence to corporate standards as well as industry best practices.</p><p>Thanks,</p><p><a href="https://scott-bollinger.com/about.html">Scott Bollinger</a> / <a href="https://twitter.com/kfalconspb">@kfalconspb</a></p><h3 id="resources"><strong>Resources</strong></h3><ol><li>VMXnet3 vs E1000e - <a href="https://rickardnobel.se/vmxnet3-vs-e1000e-and-e1000-part-1">https://rickardnobel.se/vmxnet3-vs-e1000e-and-e1000-part-1</a></li><li><a href="https://rickardnobel.se/vmxnet3-vs-e1000e-and-e1000-part-1">What's faster - </a><a href="https://www.ntpro.nl/blog/archives/1478-Whats-faster-E1000-or-VMXNET3-lets-see-what-PassMarks-PerformanceTest-says.html">https://www.ntpro.nl/blog/archives/1478-Whats-faster-E1000-or-VMXNET3-lets-see-what-PassMarks-PerformanceTest-says.html</a></li></ol>
        </div>


        <footer class="post-footer">

            <div class="authors">
                <a class="author-box" href="/author/kfalconspb/">
                    <img class="author-profile-image" src="http://Scott-Bollinger.com/content/images/2019/10/kfalconspb.jpg" alt="Scott Bollinger / @kfalconspb" />
                    <section class="author-box-content">
                        <div class="author-box-label">Author</div>
                        <h5 class="author-box-name">Scott Bollinger / @kfalconspb</h5>
                        <p>I&#x27;m Scott Bollinger / @kfalconspb, and have been an IT professional for 25 years. Half that time, in a Fortune 50 financial corporation, and the other half with small/medium size businesses.</p>
                    </section>
                </a>
            </div>

        </footer>

    </section>

</main>


<script>
    var images = document.querySelectorAll('.kg-gallery-image img');
    images.forEach(function (image) {
        var container = image.closest('.kg-gallery-image');
        var width = image.attributes.width.value;
        var height = image.attributes.height.value;
        var ratio = width / height;
        container.style.flex = ratio + ' 1 0%';
    })
</script>


        <div id="copyright">
            <ul>
                <li><Scott-Bollinger.com> Copyright &copy; 2019 <a href="/author/kfalconspb/">Scott Bollinger</a> / <a href="https://twitter.com/kfalconspb" target="_blank">@kfalconspb</a></li>
            </ul>
        </div>

    </div>


    <script src="/assets/main/js/jquery.min.js?v=2acc13b332"></script>
    <script src="/assets/main/js/jquery.scrollex.min.js?v=2acc13b332"></script>
    <script src="/assets/main/js/jquery.scrolly.min.js?v=2acc13b332"></script>
    <script src="/assets/main/js/browser.min.js?v=2acc13b332"></script>
    <script src="/assets/main/js/breakpoints.min.js?v=2acc13b332"></script>
    <script src="/assets/main/js/util.js?v=2acc13b332"></script>
    <script src="/assets/main/js/main.js?v=2acc13b332"></script>

    

</body>
</html>
