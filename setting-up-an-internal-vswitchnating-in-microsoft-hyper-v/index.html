<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Setting up an Internal vSwitch
NATing in Microsoft Hyper-V</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/main/css/main.css?v=12769605f4" />
    <noscript><link rel="stylesheet" href="/assets/main/css/noscript.css?v=12769605f4" /></noscript>

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="canonical" href="https://scott-bollinger.com/setting-up-an-internal-vswitchnating-in-microsoft-hyper-v/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://scott-bollinger.com/setting-up-an-internal-vswitchnating-in-microsoft-hyper-v/amp/" />
    
    <meta property="og:site_name" content="Scott-Bollinger.com" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Setting up an Internal vSwitch
NATing in Microsoft Hyper-V" />
    <meta property="og:description" content="Powershell FTWBeing used to VMware Workstation, where NATing is a few GUI clicks away, I couldn&#x27;t find a GUI way of configuring it in Hyper-V. inside local outside hokey pokey; Turn yourself aroundI don&#x27;t mind the command line and actually prefer it sometimes. The PowerShell equivent didn&#x27;t end up being" />
    <meta property="og:url" content="https://scott-bollinger.com/setting-up-an-internal-vswitchnating-in-microsoft-hyper-v/" />
    <meta property="article:published_time" content="2017-02-06T17:00:00.000Z" />
    <meta property="article:modified_time" content="2019-10-20T12:57:03.000Z" />
    <meta property="article:tag" content="Virtualization" />
    <meta property="article:tag" content="Network" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Setting up an Internal vSwitch
NATing in Microsoft Hyper-V" />
    <meta name="twitter:description" content="Powershell FTWBeing used to VMware Workstation, where NATing is a few GUI clicks away, I couldn&#x27;t find a GUI way of configuring it in Hyper-V. inside local outside hokey pokey; Turn yourself aroundI don&#x27;t mind the command line and actually prefer it sometimes. The PowerShell equivent didn&#x27;t end up being" />
    <meta name="twitter:url" content="https://scott-bollinger.com/setting-up-an-internal-vswitchnating-in-microsoft-hyper-v/" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Scott Bollinger / @kfalconspb" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Virtualization, Network" />
    <meta name="twitter:site" content="@kfalconspb" />
    <meta name="twitter:creator" content="@kfalconspb" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Scott-Bollinger.com",
        "url": "https://scott-bollinger.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://scott-bollinger.com/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "Scott Bollinger / @kfalconspb",
        "image": {
            "@type": "ImageObject",
            "url": "https://scott-bollinger.com/content/images/2019/10/kfalconspb.jpg",
            "width": 399,
            "height": 399
        },
        "url": "https://scott-bollinger.com/author/kfalconspb/",
        "sameAs": [
            "http://Scott-Bollinger.com",
            "https://twitter.com/kfalconspb"
        ]
    },
    "headline": "Setting up an Internal vSwitch\nNATing in Microsoft Hyper-V",
    "url": "https://scott-bollinger.com/setting-up-an-internal-vswitchnating-in-microsoft-hyper-v/",
    "datePublished": "2017-02-06T17:00:00.000Z",
    "dateModified": "2019-10-20T12:57:03.000Z",
    "keywords": "Virtualization, Network",
    "description": "Powershell FTW\nBeing used to VMware Workstation, where NATing is a few GUI clicks away, I\ncouldn&#x27;t find a GUI way of configuring it in Hyper-V.\n\ninside local outside hokey pokey; Turn yourself around\nI don&#x27;t mind the command line and actually prefer it sometimes. The PowerShell\nequivent didn&#x27;t end up being too bad. Not like the first time doing Cisco NAT\nfrom the CLI.\n\nSetting up NAT\nThe first code block is the generic commands from the Microsoft reference\ndocument the second one is what I used ",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://scott-bollinger.com/"
    }
}
    </script>

    <meta name="generator" content="Ghost 3.14" />
    <link rel="alternate" type="application/rss+xml" title="Scott-Bollinger.com" href="https://scott-bollinger.com/rss/" />
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-48318522-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-48318522-3');
</script>

    <style>#wrapper>.bg {background-image: url(/assets/images/overlay.png?v=12769605f4),linear-gradient(0deg, rgba(0,0,0,0.1), rgba(0,0,0,0.1)),url("/content/images/2019/10/asset-268-3.jpg") }</style>

</head>
<body class="is-preload post-template tag-virtualization tag-network">

    <div id="wrapper" >


        <header id="header">
                <a href="https://scott-bollinger.com" class="logo">Scott-Bollinger.com</a>
        </header>

            <nav id="nav">
    <ul class="links">
        <li class="nav-home "><a href="https://scott-bollinger.com/">Home</a></li>
        <li class="nav-disclaimer "><a href="https://scott-bollinger.com/disclaimer/">Disclaimer</a></li>
        <li class="nav-about "><a href="https://scott-bollinger.com/author/kfalconspb/">About</a></li>
    </ul>
    <ul class="icons">
        <li><a href="https://twitter.com/kfalconspb" class="icon fa-twitter" title="Twitter"><span class="label">Twitter</span></a></li>
        <li><a href="https://scott-bollinger.com/rss/" class="icon fa-rss" target="_blank" rel="noopener"><span class="label" title="RSS">RSS</span></a></li>
    </ul>
</nav>


        

<main id="main">

    <section class="post">

        <header class="major">
            <span class="date">February 6, 2017</span>
            <h1>Setting up an Internal vSwitch
NATing in Microsoft Hyper-V</h1>
        </header>


        <div class="content">
            <h3 id="powershell-ftw"><strong><strong>Powershell FTW</strong></strong></h3><p>Being used to VMware Workstation, where NATing is a few GUI clicks away, I couldn't find a GUI way of configuring it in Hyper-V.</p><h3 id="inside-local-outside-hokey-pokey-turn-yourself-around"><strong><strong>inside local outside hokey pokey; Turn yourself around</strong></strong></h3><p>I don't mind the command line and actually prefer it sometimes. The PowerShell equivent didn't end up being too bad. Not like the first time doing Cisco NAT from the CLI.</p><h2 id="setting-up-nat"><strong><strong>Setting up NAT</strong></strong></h2><p>The first code block is the generic commands from the Microsoft reference document the second one is what I used in my lab.</p><h3 id="create-internal-vswitch-for-natnew-vmswitch-switchname-switchname-switchtype-internal">Create Internal vSwitch for NAT<code>New-VMSwitch -SwitchName "SwitchName" -SwitchType Internal</code></h3><h3 id="configure-the-nat-gatewaynew-netipaddress-ipaddress-prefixlength-interfaceindex">Configure the NAT gateway<code>New-NetIPAddress -IPAddress -PrefixLength -InterfaceIndex</code></h3><h3 id="configure-the-nat-networknew-netnat-name-internalipinterfaceaddressprefix">Configure the NAT network<code>New-NetNat -Name -InternalIPInterfaceAddressPrefix</code></h3><h3 id="what-i-used-in-my-lab">What I Used in My Lab</h3><p><code>New-VMSwitch –SwitchName "NATvSwitch" –SwitchType Internal</code><br><code>New-NetIPAddress –IPAddress 172.143.1.1 -PrefixLength 24 -InterfaceAlias "vEthernet (NATSwitch)"</code><br><code>New-NetNat –Name myNATnetwork –InternalIPInterfaceAddres</code></p><h3 id="there-can-be-only-one"><strong><strong>There Can Be Only One</strong></strong></h3><p>Windows (WinNAT) only supports one internal NAT subnet prefix, trying to create multiple NATs will place the system into an unknown state. (1)</p><h3 id="references"><strong><strong>References</strong></strong></h3><ol><li><a href="https://docs.microsoft.com/en-us/virtualization/hyper-v-on-windows/user-guide/setup-nat-network/">https://docs.microsoft.com/en-us/virtualization/hyper-v-on-windows/user-guide/setup-nat-network/</a></li><li><a href="https://www.thomasmaurer.ch/2016/05/set-up-a-hyper-v-virtual-switch-using-a-nat-network/">https://www.thomasmaurer.ch/2016/05/set-up-a-hyper-v-virtual-switch-using-a-nat-network/</a></li></ol>
        </div>


        <footer class="post-footer">

            <div class="authors">
                <a class="author-box" href="/author/kfalconspb/">
                    <img class="author-profile-image" src="https://scott-bollinger.com/content/images/2019/10/kfalconspb.jpg" alt="Scott Bollinger / @kfalconspb" />
                    <section class="author-box-content">
                        <div class="author-box-label">Author</div>
                        <h5 class="author-box-name">Scott Bollinger / @kfalconspb</h5>
                        <p>I&#x27;m Scott Bollinger / @kfalconspb, and have been an IT professional for over 25 years. Half that time, in a Fortune 50 financial corporation, and the other half with small/medium size businesses.</p>
                    </section>
                </a>
            </div>

        </footer>

    </section>

</main>


<script>
    var images = document.querySelectorAll('.kg-gallery-image img');
    images.forEach(function (image) {
        var container = image.closest('.kg-gallery-image');
        var width = image.attributes.width.value;
        var height = image.attributes.height.value;
        var ratio = width / height;
        container.style.flex = ratio + ' 1 0%';
    })
</script>


        <div id="copyright">
            <ul>
                <li><Scott-Bollinger.com> Copyright &copy; 2020 <a href="/author/kfalconspb/">Scott Bollinger</a> / <a href="https://twitter.com/kfalconspb" target="_blank">@kfalconspb</a></li>
            </ul>
        </div>

    </div>


    <script src="/assets/main/js/jquery.min.js?v=12769605f4"></script>
    <script src="/assets/main/js/jquery.scrollex.min.js?v=12769605f4"></script>
    <script src="/assets/main/js/jquery.scrolly.min.js?v=12769605f4"></script>
    <script src="/assets/main/js/browser.min.js?v=12769605f4"></script>
    <script src="/assets/main/js/breakpoints.min.js?v=12769605f4"></script>
    <script src="/assets/main/js/util.js?v=12769605f4"></script>
    <script src="/assets/main/js/main.js?v=12769605f4"></script>

    

</body>
</html>
